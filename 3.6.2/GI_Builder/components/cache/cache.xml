<?xml version="1.0" ?>
<!--
  ~ Copyright (c) 2001-2008, TIBCO Software Inc.
  ~ Use, modification, and distribution subject to terms of license.
  -->
<serialization xmlns="urn:tibco.com/v3.0">
  <name><![CDATA[]]></name>
  <icon><![CDATA[]]></icon>
  <description><![CDATA[]]></description>
  <onBeforeDeserialize><![CDATA[]]></onBeforeDeserialize>
  <onAfterDeserialize><![CDATA[

objJSX.doActivate = function() {
  jsx3.ide.updateCacheSleep();
};

objJSX.doEditorChanged = function() {
  jsx3.sleep(this._doEditorChanged, "jsx3.ide.palette.cache", this, true);
};

objJSX._doEditorChanged = function() {
  jsx3.ide.updateCacheForActive();
};

objJSX.doCleanup = function() {
  jsx3.IDE.unsubscribe(jsx3.ide.events.ACTIVE_EDITOR_CHANGED, this);
};

objJSX.updateButtonState = function() {
  var objTree = this.getDescendantOfName('jsxcache');
  var buttons = this.getDescendantsOfType(jsx3.gui.ToolbarButton);
  var ids = objTree.getValue();
  var nodes = [];
  for (var i = 0; i < ids.length; i++)
    nodes[i] = objTree.getRecordNode(ids[i]);

  OUTER: for (var i = 0; i < buttons.length; i++) {
    if (nodes.length == 0) {
      buttons[i].setEnabled(jsx3.gui.Form.STATEDISABLED, true);
    } else {
      for (var j = 0; j < nodes.length; j++) {
        if (buttons[i].notsystem && nodes[j].getAttribute("system") == "1") {
          buttons[i].setEnabled(jsx3.gui.Form.STATEDISABLED, true);
          continue OUTER;
        }
      }
      buttons[i].setEnabled(jsx3.gui.Form.STATEENABLED, true);
    }
  }
};

objJSX.onInit = function() {
  // updateCache() looks for the presence of the tree in this palette so we need to timeout to make sure it actually exists
  var editor = jsx3.ide.getActiveEditor();
  if (editor != null)
    this.doActivate();
};

jsx3.IDE.subscribe(jsx3.ide.events.ACTIVE_EDITOR_CHANGED, objJSX, "doEditorChanged");
objJSX.onInit();

  ]]></onAfterDeserialize>
    <object type="jsx3.gui.Block">
      <dynamics />
      <variants jsxleft="0" jsxtop="0" jsxoverflow="2" />
      <strings jsxname="jsx_ide_cache_contentblock" jsxwidth="100%" jsxheight="100%" jsxhelpid="ide.palette.cache"/>
      <events jsxdestroy="this.doCleanup();" />
        <object type="jsx3.gui.Block">
          <dynamics jsxtext="_cch_title"/>
          <variants jsxleft="0" jsxtop="0" jsxoverflow="2" jsxwidth="0" jsxheight="0" jsxrelativeposition="0"/>
          <strings jsxname="jsx_ide_palette_title" jsxvisibility="hidden"/>
        </object>
        <object type="jsx3.gui.LayoutGrid">
          <variants jsxrelativeposition="0" jsxoverflow="2" />
          <strings jsxname="jsx_ide_cache_layout" jsxrows="26,*" jsxwidth="100%" jsxheight="100%"/>
          <events />
          <properties />
            <object type="jsx3.gui.WindowBar">
              <dynamics jsxbgcolor="@Solid Medium" jsxborder="@Outset"/>
              <variants jsxfontsize="10" jsxbartype="2" jsxoverflow="3" jsxrelativeposition="1" />
              <strings jsxname="jsx_ide_cache_bar" />
                <object type="jsx3.gui.ToolbarButton">
                  <dynamics jsxtip="_gen_viewedit"/>
                  <variants jsxenabled="0" />
                  <strings jsxname="_ide_tbb_cache_edit" jsximage="images/icon_21.gif" />
                  <events jsxexecute="jsx3.ide.editSelectedCacheDoc();"/>
                </object>
                <object type="jsx3.gui.ToolbarButton">
                  <dynamics jsxtip="_gen_viewformat"/>
                  <variants jsxenabled="0" />
                  <strings jsxname="_ide_tbb_cache_viewmarkup" jsximage="images/icon_20.gif" />
                  <events jsxexecute="jsx3.ide.viewSelectedCacheDoc();"/>
                </object>
                <object type="jsx3.gui.ToolbarButton">
                  <dynamics jsxtip="_gen_closedoc"/>
                  <variants jsxenabled="0" notsystem="1" />
                  <strings jsxdivider="1" jsxname="_ide_tbb_cache_delete" jsximage="images/icon_24.gif" />
                  <events jsxexecute="jsx3.ide.deleteCacheDocument();"/>
                </object>
            </object>
            <object type="jsx3.gui.Block">
              <dynamics jsxborder="@Outset"/>
              <variants jsxleft="0" jsxtop="0" jsxoverflow="1" />
              <strings jsxname="jsx_ide_cache_treeblock" jsxwidth="100%" jsxheight="100%"/>
                <object type="jsx3.gui.Tree">
                  <dynamics jsxpadding="@8Pixel" jsxbgcolor="@Solid Light" jsxxmlurl="treeCache" />
                  <variants jsxmultiselect="1" />
                  <strings jsxuseroot="0" jsxxmlid="jsxcache_xml" jsxname="jsxcache" jsxmenu="jsxmenu_cache" jsxwidth="100%" jsxheight="100%"/>
                  <events jsxexecute="jsx3.ide.editSelectedCacheDoc();" jsxchange="this.getAncestorOfName('jsx_ide_cache_contentblock').updateButtonState();" jsxmenu="jsx3.ide.configCacheMenu(this,objMENU);"/>
                  <xslparameters jsxindent="16"/>
                </object>
                <object type="jsx3.gui.Menu">
                  <dynamics jsxxmlurl="mnuCache"/>
                  <strings jsxname="jsxmenu_cache" jsxxmlid="mnuCache" jsxdisplay="none"/>
                </object>
            </object>
        </object>
    </object>
</serialization>
